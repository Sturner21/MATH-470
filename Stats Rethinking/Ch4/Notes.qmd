---
title: "Notes"
format: html
---

# Import Libraries

```{r}
library(rethinking)
library(tidyverse)
```

# 4.1 - Why normal dists are normal

```{r}
#Simulate flipping a coin 16 times and walking depending on the outcome

pos <- replicate(1000, sum(runif(16,-1,1)))

hist(pos)
```

## 4.1.2 Normality by multiplication

```{r}
growth <- replicate(10000, prod(1+runif(12,0,0.1)))

dens(growth, norm.comp=TRUE)
```

## 4.1.3 Normal by log-multiplication

```{r}
log.big <- replicate(10000, log(prod(1+runif(12,0,0.5))))
dens(log.big)
```

# 4.2 - A language for describing models

1.  We recognize a set of variables to work with. Some of these are observable, and are called *data.* Others are unobservable things like rates and averages, which are called *parameters*.
2.  We define each variable either in terms of the other variables or in terms of a probability distribution.
3.  The combination of variables and their probability distributions defines a *joint generative model* that can be used both to simulate hypothetical observations as well as analyze real ones.

W \~ Binomial(*N,p*) - Read as, "The count *W* is distributed binomially with sample size *N* and probability *p*.

p \~ Uniform(0,1) - Read as, "The prior for *p* is assumed to be uniform between zero and one.

Both of the above lines in the model are stochastic, as indicated by the \~. A stochastic relationship is just a mapping of a variable or parameter onto a distribution. It is stochastic because no single instance of he variable on the left is known with certainty.

# 4.3 - Gaussian model of height

```{r}
data(Howell1)
d <- Howell1
str(d)
#height - cm's
#weight - kg's
#age - years
#gender - 1=Male, 0=Female
```

```{r}
precis(d)
```

```{r}
#Book only wants to work with adults
d2 <- d[d$age > 18,]
```

## 4.3.2 The model

```{r}
dens(d2$height)
```

Height is approximately normal so we can describe it as: $h_i \sim$ Normal($\mu,\sigma$).

We need priors which the book gives us as: $\mu\sim Normal(178,20)$ and $\sigma\sim Uniform(0,50)$.

```{r}
#Plot the priors
curve(dnorm(x, 178, 20), from=100, to=250)
```

```{r}
curve(dunif(x,0,50), from=-10, to=60)
```

```{r}
#Prior Predictive simulation
sample_mu <- rnorm(1e4, 178, 20)
sample_sigma <- runif(1e4, 0, 50)
prior_h <- rnorm(1e4, sample_mu, sample_sigma)
dens(prior_h)
```

## 4.3.3 Grid approximation of the posterior

```{r}
#Grid approximation of the posterior
mu.list <- seq(from=150, to=160, length.out=100)
sigma.list <- seq(from=7, to=9, length.out=100)
post <- expand.grid(mu=mu.list, sigma=sigma.list)
post$LL <- sapply(1:nrow(post), function(i) sum(
  dnorm(d2$height, post$mu[i], post$sigma[i], log=TRUE)))
post$prod <- post$LL + dnorm(post$mu, 178, 20, TRUE) + dunif(post$sigma, 0, 50, TRUE)
post$prob <- exp(post$prod - max(post$prod))
image_xyz(post$mu, post$sigma, post$prob)
```

## 4.3.4 Sampling from the posterior
